# coding=utf-8
__author__ = 'zhangteng'

from db import DB
from config import HMySQL
import time

conn = DB(HMySQL())

day_l = ['2017_09_01','2017_09_02','2017_09_03','2017_09_04','2017_09_05','2017_09_06','2017_09_07','2017_09_08','2017_09_09','2017_09_10','2017_09_11','2017_09_12','2017_09_13','2017_09_14','2017_09_15','2017_09_16','2017_09_17','2017_09_18','2017_09_19','2017_09_20','2017_09_21','2017_09_22','2017_09_23','2017_09_24','2017_09_25','2017_09_26','2017_09_27','2017_09_28','2017_09_29','2017_09_30','2017_10_01','2017_10_02','2017_10_03','2017_10_04','2017_10_05','2017_10_06','2017_10_07','2017_10_08','2017_10_09','2017_10_10','2017_10_11','2017_10_12','2017_10_13','2017_10_14','2017_10_15','2017_10_16','2017_10_17','2017_10_18','2017_10_19','2017_10_20','2017_10_21','2017_10_22','2017_10_23','2017_10_24','2017_10_25','2017_10_26','2017_10_27','2017_10_28','2017_10_29','2017_10_30','2017_10_31','2017_11_01','2017_11_02','2017_11_03','2017_11_04','2017_11_05','2017_11_06','2017_11_07','2017_11_08','2017_11_09','2017_11_10','2017_11_11','2017_11_12','2017_11_13','2017_11_14','2017_11_15','2017_11_16','2017_11_17','2017_11_18','2017_11_19','2017_11_20','2017_11_21','2017_11_22','2017_11_23']
table_name = 'dm_user_behavior_path_yyyymmdd'

for day in day_l:
    begin = time.time()
    update_sql = "delete from %s WHERE day='%s'" % (table_name, day)
    result = conn.execute(update_sql)
    end = time.time()
    print(day, "rows ", result.rowcount, "cost", end-begin)
